package com.choi.petairbnb2;


import com.codename1.io.ConnectionRequest;
import com.codename1.io.JSONParser;
import com.codename1.io.Log;
import com.codename1.io.NetworkManager;
import com.codename1.system.NativeInterface;
import com.codename1.ui.*;
import com.codename1.ui.events.ActionEvent;
import com.codename1.ui.events.ActionListener;
import com.codename1.ui.layouts.BorderLayout;
import com.codename1.ui.layouts.BoxLayout;
import com.codename1.ui.layouts.GridLayout;
import com.codename1.ui.plaf.UIManager;
import com.codename1.ui.util.Resources;
import org.json.JSONObject;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.Map;

/**
 * This file was generated by <a href="https://www.codenameone.com/">Codename One</a> for the purpose
 * of building native mobile applications using Java.
 */
public class MyApplication {

    private Form current;
    private String url = "http://kjc.ma1geek.org/test.php";
    private String tempText;
    JSONParser json;
    private JSONObject bb, id;
    private Resources theme;
    private Label first , last ,ad, ads, z, ct, st, country1;
    private TextField txtFirst,txtLast, firstn, lastn, ad1, ad2, zip, city, state1, country;
    private Button forward,back,make, pay, submit, listingB, list2, back2, back3, gmapdemo;
    private Container panela,panelb,panelba,panel3, panel2, panel4;
    private int x;
    private Image milton;
    ConnectionRequest r;
    LinkedHashMap<Integer,Object> userArrayMap=new LinkedHashMap<>();
    LinkedHashMap<Integer,Object> userData=new LinkedHashMap<>();
    ArrayList userArray;
    ReadParseJson q;
    PayForm p;
    Resources res1;
    ListingForm formL;
    ListingDetails listDTL;
    ArrayList<String> dt;
    UserForm userf;
    GMAPS gmap;



    public void init(Object context) {
        theme = UIManager.initFirstTheme("/theme");


        // Enable Toolbar on all Forms by default
        Toolbar.setGlobalToolbar(true);

        // Pro only feature, uncomment if you have a pro subscription
        // Log.bindCrashProtection(true);
    }

    public void start() {
        if(current != null){
            current.show();
            return;
        }
        Form hi = new Form("Search", BoxLayout.y());
        Form pay1 = new Form("Payment", BoxLayout.y());
        Form listing = new Form("Listings Around You", BoxLayout.y());
        Form listingD = new Form("Details", BoxLayout.y());

        Toolbar tb = hi.getToolbar();
        Toolbar t1 = pay1.getToolbar();
        Image icon = theme.getImage("icon.png");
        Container topBar = BorderLayout.east(new Label(icon));
        Container topB1 = BorderLayout.east(new Label(icon));
        q = new ReadParseJson();
        dt = q.ReadParseJson();
        pay= new Button("Payment");
        p = new PayForm();
        formL = new ListingForm();
        listDTL = new ListingDetails();
        gmap = new GMAPS();
        back = new Button("Back");
        back2 = new Button("Back");
        back3 = new Button("Back");
        submit = new Button("Submit");
        listingB = new Button("Listings");
        gmapdemo = new Button("GMAP DEMO");
        list2 = new Button("Listing 1");
        firstn = new TextField();
        lastn = new TextField();
        ad1 = new TextField();
        ad2 = new TextField();
        zip = new TextField();
        city = new TextField();
        state1 = new TextField();
        country = new TextField();





        panela=new Container();
        panelb=new Container();
        panelba=new Container();
        panel2 = new Container();
        panel3 = new Container();
        panel4 = new Container();


        /*
        try {
            milton= Image.createImage("/mpic.jpg");
        } catch (IOException e1) {
            e1.printStackTrace();
        }

        img= new Label("PIC"){
                    @Override
                    public void paint(Graphics g) {
                        // red color
                        //  g.setColor(0xff0000);
                        g.drawImage(milton,this.getX(),this.getY(),this.getWidth(),this.getHeight());
                        g.drawString("Hales", 10,10);

                        // paint the screen in red
                        // g.fillRect(getX(), getY(), 20,20);

                        // draw hi world in white text at the top left corner of the screen
                        //  g.setColor(0xFF9933);
                        if(x>0) {
                            g.drawString(team[0].first, (this.getWidth() / 2) - 20, getY() + this.getHeight() / 2);
                        }
            }
        };

*/

        panela.setLayout(BoxLayout.y());
        panela.add(pay);
        panela.add(listingB);
        panela.add(gmapdemo);
        panel2.setLayout(new GridLayout(11, 2));
        panel3.setLayout(BoxLayout.y());
        panel4.setLayout(BoxLayout.y());

        first = new Label("First Name");
        last = new Label("Last");
        ad = new Label("Address 1");
        ads = new Label("Address 2");
        z = new Label("Zipcode");
        ct = new Label("City");
        st = new Label("State");
        country1 = new Label("Country");

        panel2.add(first);
        panel2.add(firstn);
        panel2.add(last);
        panel2.add(lastn);
        panel2.add(ad);
        panel2.add(ad1);
        panel2.add(ads);
        panel2.add(ad2);
        panel2.add(z);
        panel2.add(zip);
        panel2.add(ct);
        panel2.add(city);
        panel2.add(st);
        panel2.add(state1);
        panel2.add(country1);
        panel2.add(country);




        panel2.add(submit);




        panel3.add(list2);



        pay1.add(back);
        pay1.add(panel2);
        listing.add(back2);
        listing.add(panel3);
        listingD.add(back3);
        listingD.add(panel4);
        String fname = firstn.getText();
        String lname = lastn.getText();
        String address = ad1.getText();
        String address2 = ad2.getText();
        String zipc = zip.getText();
        String state = state1.getText();
        String nation = country.getText();






        pay.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent evt) {
                pay1.show();
                back.addActionListener(new ActionListener() {
                    @Override
                    public void actionPerformed(ActionEvent evt) {
                        hi.showBack();
                    }
                });

            }
        });

        listingB.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent evt) {
                listing.show();
                back2.addActionListener(new ActionListener() {
                    @Override
                    public void actionPerformed(ActionEvent evt) {
                        hi.showBack();
                    }
                });
            }
        });

        list2.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent evt) {
                listingD.show();
                back3.addActionListener(new ActionListener() {
                    @Override
                    public void actionPerformed(ActionEvent evt) {

                    }
                });
            }
        });

        gmapdemo.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent evt) {
                gmap.start();
                hi.setVisible(false);
            }
        });


        panelb.setLayout(new GridLayout(2,1));
        panelb.add(panelba);


       for(int i = 0; i< dt.size();i++){
           panela.add(dt.get(i));
       }



        hi.setLayout(new GridLayout(2,1));

        hi.addComponent(panela);
        hi.addComponent(panelb);


        Image duke = null;
        try {
            duke = Image.createImage("/user.png");
        } catch(IOException err) {
            Log.e(err);
        }
        int fiveMM = Display.getInstance().convertToPixels(5);
        final Image finalDuke = duke.scaledWidth(fiveMM);
        Toolbar.setGlobalToolbar(true);


/*
        hi.add(new InfiniteProgress());
        Display.getInstance().scheduleBackgroundTask(()-> {
                    // this will take a while...
                    //Contact[] cnts = Display.getInstance().getAllContacts(true, true, true, true, false, false);


                    Display.getInstance().callSerially(() -> {
                        hi.removeAll();
                        for (String c : dt) {
                            MultiButton m = new MultiButton();
                            m.setTextLine1(c);
                    /*
                    m.setTextLine2(c.getPrimaryPhoneNumber());
                    Image pic = c.getPhoto();
                    if(pic != null) {
                        m.setIcon(finalDuke);
                    } else {
                        m.setIcon(finalDuke);
                    }
                    hi.add(m);
                }

                        }
                        hi.revalidate();


                    });
                });

                    hi.getToolbar().addSearchCommand(e -> {
                        String text = (String) e.getSource();
                        if (text == null || text.length() == 0) {
                            // clear search
                            for (Component cmp : hi.getContentPane()) {
                                cmp.setHidden(false);
                                cmp.setVisible(true);
                            }
                            hi.getContentPane().animateLayout(150);
                        } else {
                            text = text.toLowerCase();
                            for (Component cmp : hi.getContentPane()) {
                                MultiButton mb = (MultiButton) cmp;
                                String line1 = mb.getTextLine1();
                                String line2 = mb.getTextLine2();
                                boolean show = line1 != null && line1.toLowerCase().indexOf(text) > -1 ||
                                        line2 != null && line2.toLowerCase().indexOf(text) > -1;
                                mb.setHidden(!show);
                                mb.setVisible(show);
                            }
                            hi.getContentPane().animateLayout(150);
                        }
                    }, 4);

*/


        topBar.add(BorderLayout.SOUTH, new Label("App Name","Sidemenu Tagline"));
        topBar.setUIID("SideCommand");
        tb.addComponentToSideMenu(topBar);


        tb.addMaterialCommandToSideMenu("Home", FontImage.MATERIAL_HOME, e -> {});
        tb.addMaterialCommandToSideMenu("Website", FontImage.MATERIAL_WEB, e ->{});
        tb.addMaterialCommandToSideMenu("Settings", FontImage.MATERIAL_SETTINGS, e ->{});
        tb.addMaterialCommandToSideMenu("About", FontImage.MATERIAL_INFO, e ->{});
        //tb.addMaterialCommandToSideMenu("Pay",FontImage.MATERIAL_PAYMENT, e ->{});
        //pay.setCommand();
        hi.show();



    }
    public  ArrayList testurl() {
        r = new ConnectionRequest();
        r.setUrl(url);
        r.setPost(false);
        r.setHttpMethod("GET");
        //r.addArgument("encoding", "json");
        NetworkManager.getInstance().addToQueueAndWait(r);
        JSONParser json = new JSONParser();
        Map data = null;


        try {

            data = json.parseJSON(new InputStreamReader(new ByteArrayInputStream(r.getResponseData())));

        } catch (IOException e) {
            e.printStackTrace();
        }

        ArrayList user = (ArrayList)data.get("root");
       System.out.println(user);
        return user;

        //ArrayList first = (ArrayList) data.get("root");
        //System.out.println(first);
        //Object s = first.get(0);
        //System.out.println(s + "'");
    }

    public String getData(int x, String str){

        userArray=testurl();
        for(int y=0;y<userArray.size();y++){
            userArrayMap.put(y,userArray.get(y));
        }
        userData=(LinkedHashMap)userArrayMap.get(x);
        String s=(String)userData.get(str);
        return(s);
    }

    public interface NativeCalls extends NativeInterface {
        void testVoid();
    }

    public void destroy() {
    }


}
